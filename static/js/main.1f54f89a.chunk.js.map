{"version":3,"sources":["logo.svg","utils.bs.js","minesweeper.bs.js","ui.bs.js","index.bs.js"],"names":["module","exports","range","start","end_","hd","tl","cartesian","l1","l2","Belt_List","e","e$prime","shuffle","FieldsComparator","Belt_Id","cmp","param","param$1","c","Caml_primitive","x","y","empty","Belt_Map","empty$1","Belt_Set","neighbourDiff","Utils","fieldNeighboursSelector","state","field","height","width","adjacentMinesCountSelector","neighbour","fields","contents","minesCountSelector","remainingMinesCountSelector","visibility","markedCountSelector","gameStatusSelector","exploded","fieldState","safeRemaining","initializeState","mines","xs","ys","Pervasives","input","n","lst","taken","undefined","minedFields","fieldsWithContents","fieldsWithState","fieldsWithStateMap","map","Math","imul","RE_EXN_ID","_1","Error","makeStateWithFieldsState","accumulateFieldsToReveal","acc","match","accWithFieldRevealed","revealFields","toReveal","update","action","TAG","_0","state$1","revealedCountSelector","_state","safeField","reinitializeStateWithSafeField","neighbours","mines$1","toReveal$1","fields$1","field$1","newFieldState","fieldState$1","fields$2","Ui$Double_click","Props","onSingleClick","onClick","onDoubleClick","children","lastClickAtRef","React","timeoutIdRef","evt","preventDefault","now","Date","isDoubleClick","current","id","clearTimeout","Caml_option","Curry","persist","timeoutId","setTimeout","arePropsEqual","oldProps","newProps","make","display","buttonContent","revealedClassName","baseClassName","contentClassName","String","className","Cn","_evt","_event","type","reducer","Minesweeper","Ui$Game","buttonContents","send","width$1","height$1","gameStatus","rows","key","displayedFieldState","remainingMines","logo","require","reducer$1","App","message","match$1","title","href","alt","src","target","ReactDOMRe","Ui"],"mappings":"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","file":"static/js/main.1f54f89a.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.e2342b05.svg\";","// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n\nimport * as Belt_List from \"bs-platform/lib/es6/belt_List.js\";\n\nfunction range(start, end_) {\n  if (start >= end_) {\n    return /* [] */0;\n  } else {\n    return {\n            hd: start,\n            tl: range(start + 1 | 0, end_)\n          };\n  }\n}\n\nfunction cartesian(l1, l2) {\n  return Belt_List.flatten(Belt_List.map(l1, (function (e) {\n                    return Belt_List.map(l2, (function (e$prime) {\n                                  return [\n                                          e,\n                                          e$prime\n                                        ];\n                                }));\n                  })));\n}\n\nfunction take(n, lst) {\n  var taken = Belt_List.take(lst, n);\n  if (taken !== undefined) {\n    return taken;\n  } else {\n    return lst;\n  }\n}\n\nvar List;\n\nvar shuffle = Belt_List.shuffle;\n\nexport {\n  List ,\n  range ,\n  cartesian ,\n  shuffle ,\n  take ,\n  \n}\n/* No side effect */\n","// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n\nimport * as Utils from \"./utils.bs.js\";\nimport * as Belt_Id from \"bs-platform/lib/es6/belt_Id.js\";\nimport * as Belt_Map from \"bs-platform/lib/es6/belt_Map.js\";\nimport * as Belt_Set from \"bs-platform/lib/es6/belt_Set.js\";\nimport * as Belt_List from \"bs-platform/lib/es6/belt_List.js\";\nimport * as Pervasives from \"bs-platform/lib/es6/pervasives.js\";\nimport * as Caml_primitive from \"bs-platform/lib/es6/caml_primitive.js\";\n\nfunction cmp(param, param$1) {\n  var c = Caml_primitive.caml_int_compare(param.x, param$1.x);\n  if (c !== 0) {\n    return c;\n  } else {\n    return Caml_primitive.caml_int_compare(param.y, param$1.y);\n  }\n}\n\nvar FieldsComparator = Belt_Id.MakeComparable({\n      cmp: cmp\n    });\n\nvar empty = Belt_Map.make(FieldsComparator);\n\nvar empty$1 = Belt_Set.make(FieldsComparator);\n\nvar neighbourDiff = Belt_List.keep(Utils.cartesian({\n          hd: -1,\n          tl: {\n            hd: 0,\n            tl: {\n              hd: 1,\n              tl: /* [] */0\n            }\n          }\n        }, {\n          hd: -1,\n          tl: {\n            hd: 0,\n            tl: {\n              hd: 1,\n              tl: /* [] */0\n            }\n          }\n        }), (function (param) {\n        if (param[0] !== 0) {\n          return true;\n        } else {\n          return param[1] !== 0;\n        }\n      }));\n\nif (Belt_List.length(neighbourDiff) !== 8) {\n  Pervasives.failwith(\"nighbourDiff should contain exactly 8 items\");\n}\n\nfunction gameWidthSelector(state) {\n  return state.width;\n}\n\nfunction gameHeightSelector(state) {\n  return state.height;\n}\n\nfunction fieldNeighboursSelector(state, field) {\n  var y = field.y;\n  var x = field.x;\n  var height = state.height;\n  var width = state.width;\n  return Belt_List.keep(Belt_List.map(neighbourDiff, (function (param) {\n                    return {\n                            x: x + param[0] | 0,\n                            y: y + param[1] | 0\n                          };\n                  })), (function (param) {\n                var y = param.y;\n                var x = param.x;\n                if (x >= 0 && x < width && y >= 0) {\n                  return y < height;\n                } else {\n                  return false;\n                }\n              }));\n}\n\nfunction fieldsSelector(state) {\n  return Belt_Map.toList(state.fields);\n}\n\nfunction fieldStateSelector(state, field) {\n  return Belt_Map.getExn(state.fields, field);\n}\n\nfunction adjacentMinesCountSelector(state, field) {\n  return Belt_List.length(Belt_List.keep(Belt_List.map(fieldNeighboursSelector(state, field), (function (neighbour) {\n                        return Belt_Map.getExn(state.fields, neighbour);\n                      })), (function (param) {\n                    return param.contents === /* Mine */0;\n                  })));\n}\n\nfunction minesCountSelector(state) {\n  return Belt_Map.size(Belt_Map.keep(state.fields, (function (param, param$1) {\n                    return param$1.contents === /* Mine */0;\n                  })));\n}\n\nfunction markedCountSelector(state) {\n  return Belt_Map.size(Belt_Map.keep(state.fields, (function (param, param$1) {\n                    return param$1.visibility === /* Marked */2;\n                  })));\n}\n\nfunction revealedCountSelector(state) {\n  return Belt_Map.size(Belt_Map.keep(state.fields, (function (param, param$1) {\n                    return param$1.visibility === /* Revealed */1;\n                  })));\n}\n\nfunction remainingMinesCountSelector(state) {\n  var mines = minesCountSelector(state);\n  var marked = markedCountSelector(state);\n  return mines - marked | 0;\n}\n\nfunction gameStatusSelector(state) {\n  var fields = state.fields;\n  var exploded = Belt_Map.some(fields, (function (param, fieldState) {\n          if (fieldState.contents) {\n            return false;\n          } else {\n            return fieldState.visibility === 1;\n          }\n        }));\n  var safeRemaining = Belt_Map.some(fields, (function (param, fieldState) {\n          if (fieldState.contents) {\n            return fieldState.visibility === 0;\n          } else {\n            return false;\n          }\n        }));\n  if (exploded) {\n    return /* Lost */2;\n  } else if (safeRemaining) {\n    return /* Playing */0;\n  } else {\n    return /* Won */1;\n  }\n}\n\nfunction makeStateWithFieldsState(width, height, fieldsWithState) {\n  var add2 = function (map, param) {\n    return Belt_Map.set(map, param[0], param[1]);\n  };\n  var fieldsWithStateMap = Belt_List.reduce(fieldsWithState, empty, add2);\n  if (Belt_Map.size(fieldsWithStateMap) !== Math.imul(width, height)) {\n    throw {\n          RE_EXN_ID: \"Assert_failure\",\n          _1: [\n            \"minesweeper.res\",\n            138,\n            2\n          ],\n          Error: new Error()\n        };\n  }\n  return {\n          width: width,\n          height: height,\n          fields: fieldsWithStateMap\n        };\n}\n\nfunction initializeState(width, height, mines) {\n  var xs = Utils.range(0, width);\n  var ys = Utils.range(0, height);\n  var fields = Belt_List.map(Utils.cartesian(xs, ys), (function (param) {\n          return {\n                  x: param[0],\n                  y: param[1]\n                };\n        }));\n  if (Belt_List.length(fields) <= mines) {\n    Pervasives.failwith(\"Too many mines for the board\");\n  }\n  var input = Utils.take(mines, Utils.shuffle(fields));\n  var minedFields = Belt_Set.mergeMany(empty$1, Belt_List.toArray(input));\n  var makeFieldWithContents = function (field) {\n    var contents = Belt_Set.has(minedFields, field) ? /* Mine */0 : /* Safe */1;\n    return [\n            field,\n            contents\n          ];\n  };\n  var fieldsWithContents = Belt_List.map(fields, makeFieldWithContents);\n  var fieldsWithState = Belt_List.map(fieldsWithContents, (function (param) {\n          return [\n                  param[0],\n                  {\n                    contents: param[1],\n                    visibility: /* Hidden */0\n                  }\n                ];\n        }));\n  return makeStateWithFieldsState(width, height, fieldsWithState);\n}\n\nfunction reinitializeStateWithSafeField(_state, width, height, mines, safeField) {\n  while(true) {\n    var state = _state;\n    var match = Belt_Map.getExn(state.fields, safeField);\n    if (match.contents) {\n      return state;\n    }\n    var newState = initializeState(width, height, mines);\n    _state = newState;\n    continue ;\n  };\n}\n\nfunction accumulateFieldsToReveal(state, field, acc) {\n  var match = Belt_Map.getExn(state.fields, field);\n  var mines = adjacentMinesCountSelector(state, field);\n  var accWithFieldRevealed = Belt_Set.add(acc, field);\n  if (mines !== 0) {\n    return accWithFieldRevealed;\n  }\n  if (!match.contents) {\n    return accWithFieldRevealed;\n  }\n  var visitNeighbour = function (acc, neighbour) {\n    if (Belt_Set.has(acc, neighbour)) {\n      return acc;\n    } else {\n      return accumulateFieldsToReveal(state, neighbour, acc);\n    }\n  };\n  return Belt_List.reduce(fieldNeighboursSelector(state, field), accWithFieldRevealed, visitNeighbour);\n}\n\nfunction revealFields(state, toReveal) {\n  return Belt_Map.mapWithKey(state.fields, (function (field, fieldState) {\n                var shouldReveal = Belt_Set.has(toReveal, field);\n                if (shouldReveal) {\n                  return {\n                          contents: fieldState.contents,\n                          visibility: /* Revealed */1\n                        };\n                } else {\n                  return fieldState;\n                }\n              }));\n}\n\nfunction update(action, state) {\n  switch (action.TAG | 0) {\n    case /* Init */0 :\n        return action._0;\n    case /* Reveal */1 :\n        var field = action._0;\n        if (gameStatusSelector(state) !== /* Playing */0) {\n          return state;\n        }\n        var firstReveal = revealedCountSelector(state) === 0;\n        var state$1;\n        if (firstReveal) {\n          var mines = minesCountSelector(state);\n          state$1 = reinitializeStateWithSafeField(state, state.width, state.height, mines, field);\n        } else {\n          state$1 = state;\n        }\n        var fieldState = Belt_Map.getExn(state$1.fields, field);\n        if (fieldState.visibility !== 1) {\n          var toReveal = accumulateFieldsToReveal(state$1, field, empty$1);\n          var fields = revealFields(state$1, toReveal);\n          return {\n                  width: state$1.width,\n                  height: state$1.height,\n                  fields: fields\n                };\n        }\n        var neighbours = fieldNeighboursSelector(state$1, field);\n        var match = Belt_List.partition(neighbours, (function (neighbour) {\n                var match = Belt_Map.getExn(state$1.fields, neighbour);\n                return match.visibility >= 2;\n              }));\n        var mines$1 = adjacentMinesCountSelector(state$1, field);\n        if (Belt_List.length(match[0]) !== mines$1) {\n          return state$1;\n        }\n        var toReveal$1 = Belt_List.reduce(Belt_List.map(match[1], (function (param) {\n                    return accumulateFieldsToReveal(state$1, param, empty$1);\n                  })), empty$1, Belt_Set.union);\n        var fields$1 = revealFields(state$1, toReveal$1);\n        return {\n                width: state$1.width,\n                height: state$1.height,\n                fields: fields$1\n              };\n    case /* ToggleMarker */2 :\n        var field$1 = action._0;\n        if (gameStatusSelector(state) !== /* Playing */0) {\n          return state;\n        }\n        var fieldState$1 = Belt_Map.getExn(state.fields, field$1);\n        var newFieldState;\n        switch (fieldState$1.visibility) {\n          case /* Hidden */0 :\n              newFieldState = {\n                contents: fieldState$1.contents,\n                visibility: /* Marked */2\n              };\n              break;\n          case /* Revealed */1 :\n              newFieldState = undefined;\n              break;\n          case /* Marked */2 :\n              newFieldState = {\n                contents: fieldState$1.contents,\n                visibility: /* Hidden */0\n              };\n              break;\n          \n        }\n        if (newFieldState === undefined) {\n          return state;\n        }\n        var fields$2 = Belt_Map.set(state.fields, field$1, newFieldState);\n        return {\n                width: state.width,\n                height: state.height,\n                fields: fields$2\n              };\n    \n  }\n}\n\nexport {\n  initializeState ,\n  makeStateWithFieldsState ,\n  gameWidthSelector ,\n  gameHeightSelector ,\n  gameStatusSelector ,\n  fieldsSelector ,\n  fieldStateSelector ,\n  adjacentMinesCountSelector ,\n  remainingMinesCountSelector ,\n  update ,\n  \n}\n/* FieldsComparator Not a pure module */\n","// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n\nimport * as Cn from \"re-classnames/src/Cn.bs.js\";\nimport * as Curry from \"bs-platform/lib/es6/curry.js\";\nimport * as Utils from \"./utils.bs.js\";\nimport * as React from \"react\";\nimport * as Belt_List from \"bs-platform/lib/es6/belt_List.js\";\nimport * as Caml_option from \"bs-platform/lib/es6/caml_option.js\";\nimport * as Minesweeper from \"./minesweeper.bs.js\";\n\nfunction Ui$Double_click(Props) {\n  var onSingleClick = Props.onClick;\n  var onDoubleClick = Props.onDoubleClick;\n  var children = Props.children;\n  var lastClickAtRef = React.useRef(0.0);\n  var timeoutIdRef = React.useRef(undefined);\n  var onClick = function (evt) {\n    evt.preventDefault();\n    var now = Date.now();\n    var lastClickAt = lastClickAtRef.current;\n    var isDoubleClick = lastClickAt + 200.0 > now;\n    lastClickAtRef.current = now;\n    var id = timeoutIdRef.current;\n    if (id !== undefined) {\n      clearTimeout(Caml_option.valFromOption(id));\n    }\n    if (isDoubleClick) {\n      return Curry._1(onDoubleClick, evt);\n    }\n    evt.persist();\n    var timeoutId = setTimeout((function (param) {\n            return Curry._1(onSingleClick, evt);\n          }), 200);\n    timeoutIdRef.current = Caml_option.some(timeoutId);\n    \n  };\n  return React.createElement(\"div\", {\n              onClick: onClick\n            }, children);\n}\n\nvar Double_click = {\n  thresholdMs: 200.0,\n  make: Ui$Double_click\n};\n\nfunction Ui$Field(Props) {\n  var mines = Props.mines;\n  var field = Props.field;\n  var fieldState = Props.fieldState;\n  var onClick = Props.onClick;\n  var onDoubleClick = Props.onDoubleClick;\n  var display;\n  switch (fieldState.visibility) {\n    case /* Hidden */0 :\n        display = /* Hidden */0;\n        break;\n    case /* Revealed */1 :\n        display = fieldState.contents ? /* Safe */({\n              mines: mines\n            }) : /* Exploded */2;\n        break;\n    case /* Marked */2 :\n        display = /* Marked */1;\n        break;\n    \n  }\n  var buttonContent;\n  if (typeof display === \"number\") {\n    switch (display) {\n      case /* Hidden */0 :\n          buttonContent = null;\n          break;\n      case /* Marked */1 :\n          buttonContent = \"üö©\";\n          break;\n      case /* Exploded */2 :\n          buttonContent = \"üí•\";\n          break;\n      \n    }\n  } else {\n    buttonContent = display.mines;\n  }\n  var baseClassName = \"game__board-field\";\n  var revealedClassName = typeof display === \"number\" ? (\n      display >= 2 ? baseClassName + \"--revealed\" : \"\"\n    ) : baseClassName + \"--revealed\";\n  var contentClassName = typeof display === \"number\" ? (\n      display >= 2 ? baseClassName + \"--exploded\" : \"\"\n    ) : baseClassName + \"--\" + String(display.mines);\n  var className = Cn.make({\n        hd: baseClassName,\n        tl: {\n          hd: revealedClassName,\n          tl: {\n            hd: contentClassName,\n            tl: /* [] */0\n          }\n        }\n      });\n  var onClick$1 = function (_evt) {\n    return Curry._1(onClick, field);\n  };\n  var onDoubleClick$1 = function (_event) {\n    return Curry._1(onDoubleClick, field);\n  };\n  return React.createElement(Ui$Double_click, {\n              onClick: onClick$1,\n              onDoubleClick: onDoubleClick$1,\n              children: React.createElement(\"div\", {\n                    className: className\n                  }, React.createElement(\"button\", {\n                        type: \"button\"\n                      }, buttonContent))\n            });\n}\n\nfunction arePropsEqual(oldProps, newProps) {\n  var oldState = oldProps.fieldState;\n  var newState = newProps.fieldState;\n  return oldState === newState;\n}\n\nvar make = React.memo(Ui$Field, arePropsEqual);\n\nvar Field = {\n  arePropsEqual: arePropsEqual,\n  make: make\n};\n\nfunction reducer(state, action) {\n  return Minesweeper.update(action, state);\n}\n\nfunction Ui$Game(Props) {\n  var width = Props.width;\n  var height = Props.height;\n  var mines = Props.mines;\n  var match = React.useReducer(reducer, undefined, (function (param) {\n          return Minesweeper.initializeState(width, height, mines);\n        }));\n  var send = match[1];\n  var state = match[0];\n  var width$1 = Minesweeper.gameWidthSelector(state);\n  var height$1 = Minesweeper.gameHeightSelector(state);\n  var xs = Utils.range(0, width$1);\n  var ys = Utils.range(0, height$1);\n  var gameStatus = Minesweeper.gameStatusSelector(state);\n  var rows = Belt_List.toArray(Belt_List.map(ys, (function (y) {\n              return React.createElement(\"div\", {\n                          key: String(y),\n                          className: \"game__board-row\"\n                        }, Belt_List.toArray(Belt_List.map(xs, (function (x) {\n                                    var field = {\n                                      x: x,\n                                      y: y\n                                    };\n                                    var fieldState = Minesweeper.fieldStateSelector(state, field);\n                                    var displayedFieldState = gameStatus !== 1 || fieldState.contents ? fieldState : ({\n                                          contents: /* Mine */0,\n                                          visibility: /* Marked */2\n                                        });\n                                    var onClick = function (field) {\n                                      return Curry._1(send, {\n                                                  TAG: /* ToggleMarker */2,\n                                                  _0: field\n                                                });\n                                    };\n                                    var onDoubleClick = function (field) {\n                                      return Curry._1(send, {\n                                                  TAG: /* Reveal */1,\n                                                  _0: field\n                                                });\n                                    };\n                                    var mines = Minesweeper.adjacentMinesCountSelector(state, field);\n                                    return React.createElement(make, {\n                                                mines: mines,\n                                                field: field,\n                                                fieldState: displayedFieldState,\n                                                onClick: onClick,\n                                                onDoubleClick: onDoubleClick,\n                                                key: String(x)\n                                              });\n                                  }))));\n            })));\n  var buttonContents;\n  switch (gameStatus) {\n    case /* Playing */0 :\n        buttonContents = \"üôÇ\";\n        break;\n    case /* Won */1 :\n        buttonContents = \"üòé\";\n        break;\n    case /* Lost */2 :\n        buttonContents = \"üòµ\";\n        break;\n    \n  }\n  var startButtonClick = function (_evt) {\n    return Curry._1(send, {\n                TAG: /* Init */0,\n                _0: Minesweeper.initializeState(width$1, height$1, mines)\n              });\n  };\n  var remainingMines = Minesweeper.remainingMinesCountSelector(state);\n  return React.createElement(\"section\", {\n              className: \"game__wrapper\"\n            }, React.createElement(\"div\", {\n                  className: \"game\"\n                }, React.createElement(\"div\", {\n                      className: \"game__header\"\n                    }, React.createElement(\"div\", {\n                          className: \"game__remaining-mines\"\n                        }, remainingMines), React.createElement(\"button\", {\n                          className: \"game__start-button\",\n                          type: \"button\",\n                          onClick: startButtonClick\n                        }, buttonContents)), React.createElement(\"div\", {\n                      className: \"game__board\"\n                    }, rows)), React.createElement(\"p\", {\n                  className: \"instructions\"\n                }, \"double-click to reveal a field / click to mark a field\"));\n}\n\nvar Game = {\n  reducer: reducer,\n  make: Ui$Game\n};\n\nvar logo = (require('./logo.svg'));\n\nfunction reducer$1(_state, action) {\n  return action._0;\n}\n\nfunction Ui$App(Props) {\n  var message = Props.message;\n  var match = React.useReducer(reducer$1, undefined);\n  var send = match[1];\n  var state = match[0];\n  var contents;\n  if (state !== undefined) {\n    var match$1;\n    switch (state) {\n      case /* Easy */0 :\n          match$1 = [\n            9,\n            9,\n            10\n          ];\n          break;\n      case /* Normal */1 :\n          match$1 = [\n            16,\n            16,\n            40\n          ];\n          break;\n      case /* Hard */2 :\n          match$1 = [\n            30,\n            16,\n            99\n          ];\n          break;\n      \n    }\n    contents = React.createElement(Ui$Game, {\n          width: match$1[0],\n          height: match$1[1],\n          mines: match$1[2]\n        });\n  } else {\n    contents = React.createElement(\"div\", {\n          className: \"difficulties__wrapper\"\n        }, React.createElement(\"h3\", undefined, \"Choose difficulty\"), React.createElement(\"div\", {\n              className: \"difficulties\"\n            }, React.createElement(\"button\", {\n                  className: \"difficulty\",\n                  title: \"Easy\",\n                  type: \"button\",\n                  onClick: (function (param) {\n                      return Curry._1(send, /* ChooseDifficulty */{\n                                  _0: /* Easy */0\n                                });\n                    })\n                }, \"üòå\"), React.createElement(\"button\", {\n                  className: \"difficulty\",\n                  title: \"Normal\",\n                  type: \"button\",\n                  onClick: (function (param) {\n                      return Curry._1(send, /* ChooseDifficulty */{\n                                  _0: /* Normal */1\n                                });\n                    })\n                }, \"üòê\"), React.createElement(\"button\", {\n                  className: \"difficulty\",\n                  title: \"Hard\",\n                  type: \"button\",\n                  onClick: (function (param) {\n                      return Curry._1(send, /* ChooseDifficulty */{\n                                  _0: /* Hard */2\n                                });\n                    })\n                }, \"üò±\")));\n  }\n  return React.createElement(\"div\", {\n              className: \"app\"\n            }, React.createElement(\"div\", {\n                  className: \"app__header\"\n                }, React.createElement(\"a\", {\n                      href: \"\"\n                    }, React.createElement(\"img\", {\n                          className: \"app__logo\",\n                          alt: \"logo\",\n                          src: logo\n                        })), React.createElement(\"h2\", undefined, message), React.createElement(\"p\", {\n                      className: \"app__credits\"\n                    }, \"by \", React.createElement(\"a\", {\n                          href: \"http://pewniak747.info\",\n                          target: \"_blank\"\n                        }, \"Tomasz Pewi≈Ñski\"), \" ¬∑ \", React.createElement(\"a\", {\n                          href: \"https://github.com/pewniak747/minesweeper-reasonml\",\n                          target: \"_blank\"\n                        }, \"source\"))), React.createElement(\"div\", {\n                  className: \"app__intro\"\n                }, contents));\n}\n\nvar App = {\n  logo: logo,\n  reducer: reducer$1,\n  make: Ui$App\n};\n\nexport {\n  Double_click ,\n  Field ,\n  Game ,\n  App ,\n  \n}\n/* make Not a pure module */\n","// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n\nimport * as Ui from \"./ui.bs.js\";\nimport * as React from \"react\";\nimport * as ReactDOMRe from \"reason-react/src/legacy/ReactDOMRe.bs.js\";\n\n((require('./index.css')));\n\nReactDOMRe.renderToElementWithId(React.createElement(Ui.App.make, {\n          message: \"Minesweeper in ReScript & React\"\n        }), \"root\");\n\nexport {\n  \n}\n/*  Not a pure module */\n"],"sourceRoot":""}